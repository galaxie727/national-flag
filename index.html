<!doctype html>
<html lang="ja">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
<title>国旗どこだと思う？</title>

<style>
:root{
  --bg-image: url("chi_base.png");
  --topbar-h: 56px;

  --paper-top: 64px;          /* ← ゲーム領域内での固定位置 */
  --paper-width: 88vw;
  --paper-height: 30vh;

  --choices-bottom: calc(env(safe-area-inset-bottom) + 14px);
  --choice-height: 10.5vh;
  --choice-font: clamp(18px,4.4vw,26px);
}

*{ box-sizing:border-box; }
html,body{
  margin:0;
  height:100%;
  font-family: system-ui, -apple-system, "Hiragino Sans", "Noto Sans JP", sans-serif;
  background:#000;
  overflow:hidden;
}

/* ===== 画面を分割（これが本命） ===== */
.app{
  height:100dvh; /* iOSで一番安定 */
  display:flex;
  flex-direction:column;
}

/* ===== トップバー ===== */
.topbar{
  flex: 0 0 auto;
  height: calc(var(--topbar-h) + env(safe-area-inset-top));
  padding-top: env(safe-area-inset-top);
  background:#000;
  display:flex;
  align-items:center;
  justify-content:center;
  z-index:10;
}
.timer{
  color:#fff;
  font-weight:900;
  letter-spacing:.12em;
  font-size:20px;
}

/* ===== ゲーム領域（ここがトップバー下スタート） ===== */
.game{
  flex: 1 1 auto;
  position:relative;
  overflow:hidden;
}

/* 背景は game の中にベタ貼り（トップバーに絶対侵入しない） */
.bg{
  position:absolute;
  inset:0;
  background-image: var(--bg-image);
  background-size: cover;
  background-position: center;
}

/* 女の子文言（透明バブル） */
.bubble{
  position:absolute;
  top: 10px;
  left:4vw;
  width:92vw;
  z-index:5;
  pointer-events:none;
}
.bubble p{
  margin:0;
  font-size: clamp(26px,6.2vw,44px);
  font-weight:900;
  color:#fff;
  text-shadow:
    0 2px 10px rgba(0,0,0,.6),
    0 1px 0 rgba(0,0,0,.4);
}

/* 旗（画用紙） */
.paper{
  position:absolute;
  top: var(--paper-top);
  left:6vw;
  width: var(--paper-width);
  height: var(--paper-height);
  background: rgba(255,255,255,.9);
  border-radius:26px;
  display:flex;
  align-items:center;
  justify-content:center;
  box-shadow: 0 22px 60px rgba(0,0,0,.25);
  z-index:4;
}
.paper img{
  width:100%;
  height:100%;
  object-fit:contain;
  padding:20px;
}

/* 選択肢 */
.choicesWrap{
  position:absolute;
  left:0; right:0;
  bottom: var(--choices-bottom);
  padding:0 16px;
  z-index:6;
}
.choices{
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:14px;
  max-width:760px;
  margin:0 auto;
}
.choice{
  height: var(--choice-height);
  border-radius:26px;
  border:none;
  color:#fff;
  font-size: var(--choice-font);
  font-weight:900;
  letter-spacing:.08em;
  cursor:pointer;
  display:flex;
  align-items:center;
  justify-content:center;
  box-shadow:
    0 10px 24px rgba(0,0,0,.25),
    inset 0 -3px 0 rgba(0,0,0,.18);
  transition: transform .06s ease, filter .06s ease;
}
.choice:active{ transform: translateY(2px); filter: brightness(.92); }

/* ポップカラー */
.color-0{ background:#7c4dff; }           /* 紫 */
.color-1{ background:#e53935; }           /* 赤 */
.color-2{ background:#26a69a; }           /* 緑 */
.color-3{ background:#fbc02d; color:#333; } /* 黄 */
</style>
</head>

<body>
<div class="app">

  <div class="topbar">
    <div class="timer"><span id="time">0.0</span>s</div>
  </div>

  <div class="game">
    <div class="bg"></div>

    <div class="bubble">
      <p>どこだと思う？</p>
    </div>

    <div class="paper">
      <img id="flag" src="flags/usa.png" alt="flag">
    </div>

    <div class="choicesWrap">
      <div class="choices" id="choices"></div>
    </div>
  </div>

</div>

<script>
const FLAGS = [
  {name:"日本",src:"flags/japan.png"},
  {name:"アメリカ",src:"flags/usa.png"},
  {name:"フランス",src:"flags/france.png"},
  {name:"ブラジル",src:"flags/brazil.png"},
  {name:"オーストラリア",src:"flags/australia.png"},
  {name:"中国",src:"flags/china.png"},
  {name:"韓国",src:"flags/korea.png"},
  {name:"イタリア",src:"flags/italy.png"}
];

let start = performance.now();
setInterval(()=>{
  document.getElementById("time").textContent =
    ((performance.now()-start)/1000).toFixed(1);
},100);

function shuffle(a){ return a.sort(()=>Math.random()-0.5); }

function render(){
  const pick = shuffle([...FLAGS]).slice(0,4);
  const answer = pick[Math.floor(Math.random()*4)];
  document.getElementById("flag").src = answer.src;

  const wrap = document.getElementById("choices");
  wrap.innerHTML="";
  shuffle(pick).forEach((c,i)=>{
    const b=document.createElement("button");
    b.className=`choice color-${i}`;
    b.textContent=c.name;
    wrap.appendChild(b);
  });
}
render();
</script>
</body>
</html>
